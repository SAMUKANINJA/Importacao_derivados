import csv
import PySimpleGUI as sg
import sys
import os
lista_url= []

data_inicio = ""
data_final = ""
caminho = []
def main():
    #tema
    sg.theme('Dark2')
    #layout
    layout = [
        [sg.Text('Data Inicial:', size=(10, 0)), sg.Input()],
        # atribui o campo data inicial e a caixa que recebe o texto,
        [sg.Text('Data Final:', size=(10, 0)), sg.Input()],  # size define o numero de caracteres permitidos
        [sg.Text('Importar Arquivo:', size=(20, 0))],
        [sg.Input(key='IN'), sg.FileBrowse(file_types=(("Arquivos .csv", "*.csv"),))],
        [sg.Text(size=(12,1), key='OUT')],
        [sg.Button('Ok'), sg.Button('Sair')],
        [sg.Text('#By Filipe and Samuel',justification='right', size=(50,0))]

    ]

    #poe aqui o caminho do incone
    window = sg.Window('Compras Colaboradores', layout, icon =r'C:\Users\samue\Pictures\vendas icone.ico')

    #Para o icone aparecer na barra de tarefas
    if sys.platform.startswith('win'):
        import ctypes
        ctypes.windll.shell32.SetCurrentProcessExplicitAppUserModelID(
            u'CompanyName.ProductName.SubProduct.VersionInformation')

    while True:       #Evento com Loop
        event, values = window.read()
        print(event, values)
        data_inicio = values[0]
        data_final = values[1]
        caminho.append(values['IN'])
        print(caminho[0])
        if event == sg.WIN_CLOSED or event == 'Sair': #fecha a janela no X ou no sair
            break
        if event == 'Ok':
            window['OUT'].update(values['IN'])
            break
    window.close() #fecha a janela

#camiho do icone novamente
if __name__ == '__main__':
    icone = r'C:\Users\samue\Pictures\vendas icone.ico'
    main()
    
lista = []
tam = 0
dic = {'ADALBERON DE SOUZA COSTA':'000004',
'ADEILDO HENRIQUE DE LIMA':'000006',
'ADEILTON TORRES DA SILVA':'000012',
'ADMILSON JOSE DA COSTA BARBOSA':'000020',
'ADRIANO BATISTA SILVA':'000029',
'ADRIANO RODRIGUES TORRES':'000031',
'ALEX SANTOS DA SILVA':'000061',
'ALEXANDRE VIANA':'000066',
'ALISSON DOS SANTOS SILVA':'000073',
'ANDERSON DA SILVA NUNES':'000089',
'ANDERSON NUNES MATIAS':'000092',
'ANDERSON ROCHA DA SILVA':'000094',
'ANTONIO COSTA FERNANDES':'000106',
'ANTONIO FELIX FILHO':'000112',
'ANTONIO FERREIRA FERRO':'000113',
'ANTONIO MARCOS DE HOLANDA CAVALCANTE':'000118',
'ANTONIO MARCOS VIEIRA CAVALCANTE':'000121',
'ANTONIO PEREIRA DE ALBUQUERQUE':'000126',
'ARIANA SANTOS SILVA':'000132',
'CARLOS ANTONIO ELIAS DE FARIAS':'000147',
'CARLOS EDUARDO DA SILVA SANTOS':'000149',
'CARLOS JORGE MONTEIRO DE SOUZA OLIVEIRA ':'000151',
'CATARINA MARIA BEZERRA DE ARAUJO':'000152',
'CHARLES DA SILVA':'000154',
'CICERO CAETANO DA SILVA':'000162',
'CICERO CARLOS MOTA DELGADO':'000163',
'CICERO DE BARROS COSTA':'000164',
'CICERO MONTEIRO DOS SANTOS':'000175',
'CICERO TAVARES DA SILVA':'000182',
'CLAUDIVAN PEREIRA DA SILVA':'000196',
'BRUNO JOSE PEREIRA SILVA':'001179',
'DAMIAO CAVALCANTE DE ALMEIDA':'000210',
'DAMIAO HONORATO ARRUDA':'000211',
'DANIEL LOPES DE MELO':'000214',
'DANIELLY RAYRA DUARTE VIEIRA':'000218',
'DAVI DE MOURA FILHO':'000225',
'DENIS NIELTO PEREIRA DA ROCHA':'000231',
'DENISSON BRUNO DE OLIVEIRA':'000232',
'DIOGO FREITAS DA SILVA':'000238',
'DJALMA JEMES LIMA DA SILVA':'000242',
'EDINALDO BALBINO DA SILVA':'000254',
'EDIVALDO CAETANO DA SILVA':'000255',
'EDSON FELIX':'000267',
'EDVALDO FARIAS DA ROCHA':'000281',
'EGUINALDO FERREIRA DA SILVA':'000286',
'ELEILTON MARLOS DA COSTA DUARTE':'000288',
'ELIANDRO SILVA DOS SANTOS':'000294',
'ELIAS DA SILVA FERREIRA':'000297',
'ELIDINALDO GOMES DA SILVA':'000300',
'ELINALDO SATURNINO SILVA':'000302',
'ELISON THIAGO DA COSTA DUARTE':'000304',
'EMERSON TENORIO CAVALCANTE':'000310',
'ERASMO GONCALVES DOS SANTOS':'000313',
'ERISVALDO SILVA DOS SANTOS':'000315',
'ERIVALDO CAVALCANTE ARAUJO':'000318',
'FABIANA DE BARROS MOTA MELO':'000329',
'FABIO ANDRE CASSIMIRO DA SILVA':'000333',
'FABIO COSTA DOS SANTOS':'000336',
'FABRICIO FERREIRA DA SILVA':'000341',
'FELIPE COSTA DE BARROS':'000342',
'FELIPE SILVA DOS SANTOS':'000343',
'FERNANDO FERREIRA FERRO':'000345',
'FERNANDO SOARES FERRO':'000347',
'FLAVIO JOSE ALVES CAVALCANTE':'000354',
'FRANCISCO DA SILVA GOMES':'000359',
'FRANCISCO RONALDO DA SILVA':'000370',
'GILMAR COSTA DA SILVA':'000391',
'GILMAR SANTOS DE OLIVEIRA':'000393',
'GILVAN B DE OLIVEIRA':'000398',
'GILVAN BARBOSA DA COSTA':'000399',
'GILVANIO BARBOSA DA SILVA':'000406',
'GINAILDO MACARIO FERREIRA':'000408',
'GIVALDO PANTA DE SOUZA':'000411',
'GUILHERME BRUNO FERREIRA DA SILVA':'000415',
'HELENILDO CORDEIRO DA SILVA':'000418',
'HELENILDO DE SOUZA':'000419',
'HELENO JOSE DA COSTA':'000420',
'HELENO JOSE DA SILVA':'000421',
'HIATA ANDERSON LIMA LAURENTINO':'000428',
'IDAIANA DOS SANTOS FEITOSA':'000435',
'IRANILDO PEREIRA DE ARAUJO':'000441',
'JAERSON MOREIRA LEITE':'000469',
'JAIRO ALVES DA SILVA':'000476',
'JAMERSON FERREIRA ARAUJO':'000482',
'JAMES HONORIO FERRO':'000485',
'JANILSON ELEOTERO FERREIRA':'000488',
'JEFFERSON ROSENDO DA SILVA091.837.324-70':'000501',
'JOAO DA SILVA VIEIRA':'000507',
'JOAO EDUARDO WANDERLEI DA SILVA SANTOS':'000509',
'JOAO EVANGELISTA DE CARVALHO':'000510',
'JOAO GAMA DA SILVA JUNIOR':'000512',
'JOAO GOMES DA SILVA':'000514',
'JOAO RODRIGUES DA SILVA':'000526',
'JONAS MEIRELES DOS SANTOS':'000537',
'JORGE LUIS GOMES DA SILVA':'000544',
'JOSE ALEXANDRE BEZERRA DA SILVA':'000556',
'JOSE BARBOSA NUNES FILHO':'000567',
'JOSE BRUNO DOS SANTOS FERNANDES':'000568',
'JOSE CARLOS DA SILVA':'000571',
'JOSE CARLOS DOS SANTOS':'000572',
'JOSE CICERO CANDIDO DO NASCIMENTO':'000579',
'JOSE CICERO DE LIMA TELES':'000583',
'JOSE CLAUDEVAN FERREIRA DE BARROS':'000600',
'JOSE DA COSTA BARBOSA':'000605',
'JOSE DUARTE DA SILVA JUNIOR':'000610',
'JOSE ELISSANDRO DA COSTA DUARTE':'000613',
'JOSE ERNANDO SILVA DOS SANTOS':'000615',
'JOSE FARIAS BEZERRA':'000620',
'JOSE FERNANDO SIMPLICIO DE OLIVEIRA':'000623',
'JOSE FERREIRA LEITE':'000625',
'JOSE GERMANO DA SILVA':'000633',
'JOSE GILDO DE SOUZA':'000634',
'JOSE GOMES DA SILVA':'000635',
'JOSE ILSON FERREIRA DA SILVA':'000644',
'JOSE JADSON DE OLIVEIRA SILVA':'000648',
'JOSE LUCAS ANDRADE DOS SANTOS':'000655',
'JOSE MAQUIEL LIMA DE OLIVEIRA':'000658',
'JOSE MARCOS DE SOUZA MENDONCA':'000664',
'JOSE MARCOS OLIVEIRA SAMPAIO':'000666',
'JOSE NELITO FERREIRA DA SILVA GOMES':'000670',
'JOSE NILSON LIMA DOS SANTOS':'000672',
'JOSE OSMANDO OLIVEIRA DOS SANTOS':'000678',
'JOSE PAIXAO DA SILVA':'000679',
'JOSE REGINALDO FONSECA  DA SILVA':'000682',
'JOSE ROBERTO DA SILVA':'000692',
'JOSE RUBENS DUARTE DE AMORIM':'000700',
'JOSE SILVA DE SA':'000704',
'JOSE WILSON SILVA DE FREITAS':'000714',
'JOSEILDO BARROS DA SILVA BRITO':'000715',
'JOSEMAR FARIAS TORRES':'000718',
'JOSIVALDO PEREIRA BARBOSA':'000729',
'JUAREZ VIEIRA DA SILVA FILHO':'000731',
'JULIENE MARIA CAVALCANTE NUNES':'000733',
'JUNIO LOPES DA SILVA':'000736',
'JUVENAL NUNES COSTA JUNIOR':'000739',
'KLEBER LEITE DA FONSECA':'000742',
'LAERCIO FARIAS DE MEDEIROS':'000748',
'LEANDRO DE OLIVEIRA PEREIRA':'000753',
'LENILSON SOUZA DE MENESES':'000759',
'LUCAS MATHEUS DO NASCIMETO ROCHA':'000770',
'LUCIANO JOSE DA SILVA':'000782',
'LUIS CARLOS SANTOS DE OLIVEIRA':'000791',
'LUIZ ANTONIO MIRANDA DA SILVA':'000799',
'LUIZ CARLOS SILVA DE ARAUJO':'000801',
'MANOEL FABIO PEREIRA DA SILVA':'000815',
'MARCELINO RAIMUNDO DE ARAUJO FILHO':'000822',
'MARCELINO SIQUEIRA DOS SANTOS':'000823',
'MARCELO DA COSTA BARBOSA':'000825',
'MARCONI PEREIRA SILVA':'000847',
'MARCOS ALBUQUERQUE DE LIMA':'000848',
'MARCOS JOSE FERREIRA DA SILVA':'000856',
'MARGARETE PORTO SILVA':'000862',
'MARIA NATALIA SOUZA RODRIGUES':'000871',
'MARIO RICARDO DA SILVA':'000877',
'MICHEL PLATINI BALBINO DA SILVA':'000891',
'MIGUEL FERREIRA DUTRA':'000895',
'MIGUEL MELO DA SILVA DO NASCIMENTO':'000896',
'MONICA DE MORAES MOTTA':'000902',
'NATHAN GABRIEL SOUZA SILVA':'000906',
'NAYARA TORRES SILVA':'000907',
'NIVALDO SILVA BARBOSA':'000919',
'OSMAR VITOR CAVALCANTE FERREIRA':'000921',
'OTAVIO FERREIRA LOPES NETO':'000922',
'PAULO SERGIO RIBEIRO DO NASCIMENTO':'000941',
'PEDRO OLIVEIRA DA SILVA':'000952',
'PEDRO PAULO AQUINO DOS SANTOS':'000953',
'PEDRO RICARDO DA SILVA':'000954',
'PEDRO SILVA GUABIRABA':'000956',
'RAFAEL LUCAS BARBOSA DE OLIVEIRA':'000963',
'RAUL BEZERRA DA SILVA':'000971',
'REGINALDO EMIDIO NASCIMENTO DOS SANTOS':'000975',
'RENILSON PEREIRA DE MELO':'000987',
'RIQUELLE TORRES DA SILVA':'000993',
'ROBERTO CANDIDO DE ARAUJO':'001003',
'ROSALVO TEIXEIRA NETO':'001021',
'ROSINEIDE CARNEIRO DA SILVA':'001025',
'ROSIVAL SENA DA SILVA':'001026',
'SAMUEL VIEIRA SAMPAIO':'001035',
'SERGIO COSTA DOS SANTOS':'001050',
'SINVALDO ALVES DOS REIS':'001061',
'SIVAL MARQUES DE LIMA':'001064',
'SIVALDO SOARES DA COSTA':'001065',
'TAIS CAVALCANTE FERRO':'001074',
'THAISA TENORIO MORAES SARMENTO':'001077',
'THAUAN DA SILVA DEFENSOR':'001079',
'THIAGO DE CAMPOS':'001083',
'TIAGO BARROS DA COSTA':'001089',
'TIAGO PALMEIRA DA SILVA':'001095',
'TONY SILVA DE MELO':'001097',
'VALDEMIR SIQUEIRA DA SILVA':'001104',
'VALDEREZ CABRAL DE MENDONCA':'001106',
'VALTER LOPES DA ROCHA':'001117',
'VITORIA ROBERTA DA SILVA RODRIGUES':'001126',
'WELLINGTON BARROS DE MESSIAS':'001133',
'WELLINGTON DE CARVALHO PEREIRA':'001135',
'WELLINGTON PEREIRA DAMIAO':'001138',
'WELLINGTON RODRIGUES DA SILVA':'001139',
'WEMERSON NUNES BARROS':'001141',
'WEVERTON VICTOR SILVA DE ALMEIDA':'001143',
'WILLAMS NASCIMENTO DE MELO':'001145',
'WILLIAM JEFFERSON DOS REIS COSTA':'001147',
'WILSON CAVALCANTE DA SILVA':'001148',
'WALLISON SANTOS DE OLIVEIRA':'001151',
'BRUNO VINICIUS DA SILVA VIEIRA':'001152',
'CLAUDIA MARCIELY BEZERRA DA SILVA':'001153',
'DAVI LIMA DA SILVA':'001154',
'ELIDMAR FLORIANO DA SILVA':'001156',
'FILIPE EMANUEL SILVA COSTA':'001157',
'JADIELE CERQUEIRA SILVA':'001158',
'LIZANIAS DE SOUZA BARROS NETO':'001159',
'MANOEL SANTOS RODRIGUES':'001160',
'MARIA JEICIANE DE MELO TENORIO':'001161',
'PEDRO FERREIRA DA SILVA NETO':'001162',
'SIMONICA RICARDO PEREIRA':'001163',
'VITORIA BRUNIELLY BARBOSA SILVA':'001164',
'VITORIA DA SILVA FEITOSA':'001165',
'MARCOS ANTONIO ALVES DE LIMA':'001166',
'JAMES BRUNO MARQUES DE ASSIS':'001167',
'LUCAS BARBOSA DA SILVA':'001168',
'FELIPE ELOI PAULINO PIMENTEL':'001169',
'LARISSA CARLA BEZERRA DE LIMA':'001170',
'SAMUEL LUCAS VIEIRA FERREIRA':'001171',
'EDSON GONCALVES DOS SANTOS':'001172',
'ANTONY MARCOS DA FONSECA SANTOS':'001173',
'SABRINA DUARTE DA SILVA':'001177'
}
print("Digite o período da importação")

basename = os.path.basename(str(caminho))
file_name = os.path.splitext(basename)[0] + ".csv"

with open(file_name, 'r', encoding='latin-1') as arquivo_csv:
    leitor = csv.reader(arquivo_csv, delimiter=';')
    for row in leitor:
        lista.append(row)
tam_lista=(len(lista))
with open('import.txt', 'w' ,encoding='utf8') as f:
    for i in range(1,tam_lista-1):
        #print(len(lista[i][4]))
        if(len(lista[i][4])==6):
            #print(lista[i][4].replace(',','').replace(' ',''))
            f.write("00000100001"+data_inicio+data_final+"00000000000000623"+"00000000000"+lista[i][4].replace(',','').replace(' ','')+
                    dic[lista[i][6]]+"F000000000000000000000000000000000000000000000000000000000000000NNNN"+"\n")
        elif(len(lista[i][4])==7):
            #print(lista[i][4].replace(',','').replace(' ',''))
            f.write("00000100001"+data_inicio+data_final+"00000000000000623"+"0000000000"+lista[i][4].replace(',','').replace(' ','')+
                    dic[lista[i][6]]+"F000000000000000000000000000000000000000000000000000000000000000NNNN"+"\n")
        else:
            f.write("00000100001"+data_inicio+data_final+"00000000000000623"+"000000000"+lista[i][4].replace(',','').replace(' ','')+
                    dic[lista[i][6]]+"F000000000000000000000000000000000000000000000000000000000000000NNNN"+ "\n")
























